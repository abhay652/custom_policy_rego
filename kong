# 1. Install Custom Kong plugin for OPA

curl -H 'Authorization: Bearer sS4bkUeZsKbiYopjtlAk24i4k6u_gBaizZYoqiwudzGzA6dE0O7ebAJRHBqnPlBfaPWDFNu2E_nb0eA2fqiqinwF-8ULvcLFmgMxjA' https://x8gy40.svc.styra.com/v1/systems/b6a38839fe194c7099db625035a4398b/assets/custom-kong-plugin.yaml | kubectl apply -f -
# 2. Configure Kong plugin for OPA authorization

curl -H 'Authorization: Bearer sS4bkUeZsKbiYopjtlAk24i4k6u_gBaizZYoqiwudzGzA6dE0O7ebAJRHBqnPlBfaPWDFNu2E_nb0eA2fqiqinwF-8ULvcLFmgMxjA' https://x8gy40.svc.styra.com/v1/systems/b6a38839fe194c7099db625035a4398b/assets/kong-plugin-config.yaml | kubectl apply -f -
# 3. Configure OPA

curl -H 'Authorization: Bearer sS4bkUeZsKbiYopjtlAk24i4k6u_gBaizZYoqiwudzGzA6dE0O7ebAJRHBqnPlBfaPWDFNu2E_nb0eA2fqiqinwF-8ULvcLFmgMxjA' https://x8gy40.svc.styra.com/v1/systems/b6a38839fe194c7099db625035a4398b/assets/opa-config.yaml | kubectl apply -n kong -f -
# 4. Install Styra Local Plane (SLP)

curl -H 'Authorization: Bearer sS4bkUeZsKbiYopjtlAk24i4k6u_gBaizZYoqiwudzGzA6dE0O7ebAJRHBqnPlBfaPWDFNu2E_nb0eA2fqiqinwF-8ULvcLFmgMxjA' https://x8gy40.svc.styra.com/v1/systems/b6a38839fe194c7099db625035a4398b/assets/slp-deployment.yaml | kubectl apply -n kong -f -

# 5. Download Helm values.yaml file with OPA sidecar

curl -H 'Authorization: Bearer sS4bkUeZsKbiYopjtlAk24i4k6u_gBaizZYoqiwudzGzA6dE0O7ebAJRHBqnPlBfaPWDFNu2E_nb0eA2fqiqinwF-8ULvcLFmgMxjA' https://x8gy40.svc.styra.com/v1/systems/b6a38839fe194c7099db625035a4398b/assets/opa-sidecar-values.yaml > opa-sidecar-values.yaml
